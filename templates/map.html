<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mapa de Estaciones</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>

    <header>
        <div class="logo"><strong>GAS</strong>Station</div>
        <a href="/" style="text-decoration: none; color: var(--primary);">Volver al inicio</a>
    </header>
    <main class="map-section">
        <nav aria-label="breadcrumb" class="mt-3">
            <ol class="breadcrumb">
                {% for item in breadcrumb %}
                    {% if loop.last %}
                        <li class="breadcrumb-item active text-capitalize" aria-current="page">{{ item }}</li>
                    {% else %}
                        <li class="breadcrumb-item text-capitalize">
                            <a href="/">{{ item }}</a>
                        </li>
                    {% endif %}
                {% endfor %}
            </ol>
        </nav>
        <h2>Localizador de Sucursales</h2>
        
        <form method="POST" class="search-box">
            <input type="text" name="lugar" placeholder="Ingrese ciudad o c칩digo postal..." required>
            <button type="submit" class="btn-primary">Buscar</button>
        </form>

        {% if error %}
            <p style="color: red;">No se pudo encontrar la ubicaci칩n especificada.</p>
        {% endif %}

        {% if lat %}
            <div id="map" style="height: 500px;"></div>
        {% endif %}
    </main>

    <footer>
        <div>Estado del Servicio: Operativo</div>
        <div>Actualizado: Febrero 2026</div>
    </footer>

    {% if lat %}
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([{{ lat }}, {{ lon }}], 13);
        
        // Usando un estilo de mapa m치s limpio (CartoDB Positron)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap'
        }).addTo(map);

        L.marker([{{ lat }}, {{ lon }}])
            .addTo(map)
            .bindPopup("<b>{{ nombre }}</b><br>Estaci칩n de Servicio")
            .openPopup();
    </script>
    {% endif %}
</body>
</html>